**AAC⾳频格式** : Advanced Audio Coding(⾼级⾳频解码) , 是⼀种由 MPEG-4 标准定义的有损⾳频压缩格式 , 由Fraunhofer发展 ,Dolby, Sony 和 AT&T 是主要的贡献者  

**ADIF** : Audio Data Interchange Format ⾳频数据交换格式。这种格式的特征是可以确定的找到这个⾳频数据的开始 , 不需进⾏在音频数据流中间开始的解码 , 即它的解码必须在明确定义的开始处进⾏。故这种格式常⽤在磁盘⽂件中  

**ADTS** : 的全称是 Audio Data Transport Stream。是AAC⾳频的传输流格式。AAC⾳频格式在MPEG-2（ISO-13318-7 2003）中有定义。AAC后来⼜被采⽤到MPEG-4标准中。这种格式的特征是它是⼀个有同步字(syncword) 的比特流(bit stream) , 解码可以在这个流中任何位置开始。它的特征类似于mp3数据流格式  

简单说 , ADTS可以在任意帧解码 , 也就是说它每⼀帧都有头信息。ADIF只有⼀个统⼀的头 , 所以必须得到所有的数据后解码  

且这两种的header的格式也是不同的 , ⽬前⼀般编码后的和抽取出的都是ADTS格式的音频流。两者具体的组织结构如下所示 :

* AAC的ADIF格式⻅下图 : 

| header() | raw_data_strean() |
| -------- | ----------------- |

* AAC的ADTS的⼀般格式⻅下图 : 

| 前帧 | syncword | header() | error_check() | raw_data_block() | 后帧 |
| ---- | -------- | -------- | ------------- | ---------------- | ---- |

空⽩处表示前后帧

有的时候当你编码AAC裸流的时候 , 会遇到写出来的AAC⽂件并不能在PC和⼿机上播放 , 很⼤的可能就是AAC⽂件的每⼀帧⾥缺少了ADTS头信息⽂件的包装拼接  

只需要加⼊头⽂件ADTS即可。⼀个AAC原始数据块⻓度是可变的 , 对原始帧加上ADTS头进⾏ADTS的封装 , 就形成了ADTS帧。
AAC⾳频⽂件的每⼀帧由 **$\color{red}{\mathbf{ADTS \\\ Header}}$** 和 **$\color{red}{\mathbf{AAC \\\ Audio \\\ Data}}$** 组成。结构体如下 : 

<img src="assets/image-20240126140331856.png" alt="image-20240126140331856" /> 

每⼀帧的ADTS的头⽂件都包含了⾳频的采样率 , 声道 , 帧⻓度等信息 , 这样解码器才能解析读取

⼀般情况下ADTS的头信息都是7个字节 , 分为两部分 :

* `adts_fixed_header();  `
* `adts_variable_header();`

其⼀为固定头信息 , 紧接着是可变头信息。固定头信息中的数据每⼀帧都相同 , ⽽可变头信息则在帧与帧之间可变  

<img src="assets/image-20240126142628785.png" alt="image-20240126142628785" /> 

* `syncword` : 同步头总是0xFFF , all bits must be 1, 代表着⼀个ADTS帧的开始
* `ID` : MPEG标识符 , 0标识MPEG-4 , 1标识MPEG-2
* `Layer` : always : '00' 
* `protection_absent` : 表示是否误码校验。Warning , set to 1 if there is no CRC and 0 if there is CRC
* `profile` : 表示使⽤哪个级别的AAC , 如01 Low Complexity(LC) --- AAC LC。有些芯⽚只⽀持AAC LC
  * 在MPEG-2 AAC中定义了3种 : 
    * <img src="assets/image-20240126145410405.png" alt="image-20240126145410405" /> 
  * `profile` 的值等于 Audio Object Type 的 值减1
  * `profile = MPEG-4 Audio Object Type - 1`  

<img src="assets/image-20240126150120499.png" alt="image-20240126150120499" /> 

<img src="assets/image-20240126150136941.png" alt="image-20240126150136941" /> 

* sampling_frequency_index：表示使⽤的采样率下标，通过这个下标在Sampling Frequencies[ ]数组中查找得知采样率的值  