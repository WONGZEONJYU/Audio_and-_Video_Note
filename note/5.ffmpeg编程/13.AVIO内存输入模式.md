# 1. `avio_alloc_context(...)`

> ```c++
> 
> AVIOContext* avio_alloc_context	(unsigned char * 	buffer,
> 								int 	buffer_size,
> 								int 	write_flag,
> 								void * 	opaque,
> 								int(*)(void *opaque, uint8_t *buf, int buf_size) 	read_packet,
>                                 int(*)(void *opaque, uint8_t *buf, int buf_size) 	write_packet,
> 								int64_t(*)(void *opaque, int64_t offset, int whence) 	seek )	
> ```

> ```tex
> Allocate and initialize an AVIOContext for buffered I/O.
> 
> It must be later freed with avio_context_free().
> 
> Parameters
> @buffer	Memory block for input/output operations via AVIOContext. The buffer must be allocated with av_malloc() and friends. It may be freed and replaced with a new buffer by libavformat. AVIOContext.buffer holds the buffer currently in use, which must be later freed with av_free().
> 
> @buffer_size	The buffer size is very important for performance. For protocols with fixed blocksize it should be set to this blocksize. For others a typical size is a cache page, e.g. 4kb.
> 
> @write_flag	Set to 1 if the buffer should be writable, 0 otherwise.
> opaque	An opaque pointer to user-specific data.
> 
> @read_packet	A function for refilling the buffer, may be NULL. For stream protocols, must never return 0 but rather a proper AVERROR code.
> 
> @write_packet	A function for writing the buffer contents, may be NULL. The function may not change the input buffers content.
> 
> @seek	A function for seeking to specified byte position, may be NULL.
> 
> Returns
> Allocated AVIOContext or NULL on failure.
> ```

